{"ast":null,"code":"const controls = document.querySelector('.controls');\nconst cameraOptions = document.querySelector('.video-options>select');\nconst video = document.querySelector('video');\nconst canvas = document.querySelector('canvas');\nconst screenshotImage = document.querySelector('img');\nconst buttons = [...controls.querySelectorAll('button')];\nlet streamStarted = false;\nconst [play, pause, screenshot] = buttons;\nconst constraints = {\n  video: {\n    width: {\n      min: 1280,\n      ideal: 1920,\n      max: 2560\n    },\n    height: {\n      min: 720,\n      ideal: 1080,\n      max: 1440\n    }\n  }\n};\n\ncameraOptions.onchange = () => {\n  const updatedConstraints = { ...constraints,\n    deviceId: {\n      exact: cameraOptions.value\n    }\n  };\n  startStream(updatedConstraints);\n};\n\nplay.onclick = () => {\n  if (streamStarted) {\n    video.play();\n    play.classList.add('d-none');\n    pause.classList.remove('d-none');\n    return;\n  }\n\n  if ('mediaDevices' in navigator && navigator.mediaDevices.getUserMedia) {\n    const updatedConstraints = { ...constraints,\n      deviceId: {\n        exact: cameraOptions.value\n      }\n    };\n    startStream(updatedConstraints);\n  }\n};\n\nconst pauseStream = () => {\n  video.pause();\n  play.classList.remove('d-none');\n  pause.classList.add('d-none');\n};\n\nconst doScreenshot = () => {\n  canvas.width = video.videoWidth;\n  canvas.height = video.videoHeight;\n  canvas.getContext('2d').drawImage(video, 0, 0);\n  screenshotImage.src = canvas.toDataURL('image/webp');\n  screenshotImage.classList.remove('d-none');\n};\n\npause.onclick = pauseStream;\nscreenshot.onclick = doScreenshot;\n\nconst startStream = async constraints => {\n  const stream = await navigator.mediaDevices.getUserMedia(constraints);\n  handleStream(stream);\n};\n\nconst handleStream = stream => {\n  video.srcObject = stream;\n  play.classList.add('d-none');\n  pause.classList.remove('d-none');\n  screenshot.classList.remove('d-none');\n};\n\nconst getCameraSelection = async () => {\n  const devices = await navigator.mediaDevices.enumerateDevices();\n  const videoDevices = devices.filter(device => device.kind === 'videoinput');\n  const options = videoDevices.map(videoDevice => {\n    return `<option value=\"${videoDevice.deviceId}\">${videoDevice.label}</option>`;\n  });\n  cameraOptions.innerHTML = options.join('');\n};\n\ngetCameraSelection();","map":{"version":3,"sources":["/Users/nickfaddis/Desktop/SLU/csCapstone/visualizing_whats_lost/react-capacitor-example/src/Camera.js"],"names":["controls","document","querySelector","cameraOptions","video","canvas","screenshotImage","buttons","querySelectorAll","streamStarted","play","pause","screenshot","constraints","width","min","ideal","max","height","onchange","updatedConstraints","deviceId","exact","value","startStream","onclick","classList","add","remove","navigator","mediaDevices","getUserMedia","pauseStream","doScreenshot","videoWidth","videoHeight","getContext","drawImage","src","toDataURL","stream","handleStream","srcObject","getCameraSelection","devices","enumerateDevices","videoDevices","filter","device","kind","options","map","videoDevice","label","innerHTML","join"],"mappings":"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","sourcesContent":["const controls = document.querySelector('.controls');\nconst cameraOptions = document.querySelector('.video-options>select');\nconst video = document.querySelector('video');\nconst canvas = document.querySelector('canvas');\nconst screenshotImage = document.querySelector('img');\nconst buttons = [...controls.querySelectorAll('button')];\nlet streamStarted = false;\n\nconst [play, pause, screenshot] = buttons;\n\nconst constraints = {\n  video: {\n    width: {\n      min: 1280,\n      ideal: 1920,\n      max: 2560,\n    },\n    height: {\n      min: 720,\n      ideal: 1080,\n      max: 1440\n    },\n  }\n};\n\ncameraOptions.onchange = () => {\n  const updatedConstraints = {\n    ...constraints,\n    deviceId: {\n      exact: cameraOptions.value\n    }\n  };\n\n  startStream(updatedConstraints);\n};\n\nplay.onclick = () => {\n  if (streamStarted) {\n    video.play();\n    play.classList.add('d-none');\n    pause.classList.remove('d-none');\n    return;\n  }\n  if ('mediaDevices' in navigator && navigator.mediaDevices.getUserMedia) {\n    const updatedConstraints = {\n      ...constraints,\n      deviceId: {\n        exact: cameraOptions.value\n      }\n    };\n    startStream(updatedConstraints);\n  }\n};\n\nconst pauseStream = () => {\n  video.pause();\n  play.classList.remove('d-none');\n  pause.classList.add('d-none');\n};\n\nconst doScreenshot = () => {\n  canvas.width = video.videoWidth;\n  canvas.height = video.videoHeight;\n  canvas.getContext('2d').drawImage(video, 0, 0);\n  screenshotImage.src = canvas.toDataURL('image/webp');\n  screenshotImage.classList.remove('d-none');\n};\n\npause.onclick = pauseStream;\nscreenshot.onclick = doScreenshot;\n\nconst startStream = async (constraints) => {\n  const stream = await navigator.mediaDevices.getUserMedia(constraints);\n  handleStream(stream);\n};\n\n\nconst handleStream = (stream) => {\n  video.srcObject = stream;\n  play.classList.add('d-none');\n  pause.classList.remove('d-none');\n  screenshot.classList.remove('d-none');\n\n};\n\n\nconst getCameraSelection = async () => {\n  const devices = await navigator.mediaDevices.enumerateDevices();\n  const videoDevices = devices.filter(device => device.kind === 'videoinput');\n  const options = videoDevices.map(videoDevice => {\n    return `<option value=\"${videoDevice.deviceId}\">${videoDevice.label}</option>`;\n  });\n  cameraOptions.innerHTML = options.join('');\n};\n\ngetCameraSelection();"]},"metadata":{},"sourceType":"module"}