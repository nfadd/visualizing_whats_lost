{"ast":null,"code":"import _objectSpread from\"/Users/nickfaddis/Desktop/SLU/csCapstone/visualizing_whats_lost/react-capacitor-example/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useRef,useEffect}from'react';import{onValue}from\"firebase/database\";import mapboxgl from'mapbox-gl';import'mapbox-gl/dist/mapbox-gl.css';//Must have this otherwise pins don't anchor\nimport firebase from'./query/connect_to_firebase.js';import{createNameDate,createThumbImage,getHistoricalImage,makeImageFullscreen,retrieveCapturedImage}from'./Sidebar';import{setPinLatLong,setUserLatLong}from'./Location';import{setIndex}from'./CameraScreen';import{jsx as _jsx}from\"react/jsx-runtime\";mapboxgl.accessToken='pk.eyJ1Ijoibmlja2ZhZGRpcyIsImEiOiJja3Vwemt0amwwbnVoMnZwZ2dreW81OTQwIn0.qerYpAFHJUlYynqbympvAA';var MapContainer=function MapContainer(){var mapContainer=useRef(null);useEffect(function(){var map=new mapboxgl.Map({container:mapContainer.current,style:'mapbox://styles/nickfaddis/ckurogok00w1l18mmby6l9zsf',center:[-90.221932,38.632511],zoom:15});map.addControl(new mapboxgl.NavigationControl(),'top-right');var geolocate=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:true},trackUserLocation:true,showUserHeading:true});map.addControl(geolocate);geolocate.on('geolocate',function(position){var userLat=position.coords.latitude;var userLong=position.coords.longitude;console.log('lat, lng',userLat,userLong);setUserLatLong(userLat,userLong);});onValue(firebase,function(snapshot){var data=snapshot.val();var keys=Object.keys(data).map(function(key){return _objectSpread({key:key},data[key]);});keys.forEach(function(element){var marker=new mapboxgl.Marker();var long=element.lng;var lat=element.lat;marker.setLngLat([long,lat]);marker.addTo(map);marker.getElement().addEventListener('click',function(){setIndex(element.key);retrieveCapturedImage(element.key);setPinLatLong(lat,long);//Variables for sidebar divs\nvar location_info_div=document.getElementById('location_info_row');var legacy_photo_div=document.getElementById('legacy_photo_row');var user_photo_div=document.getElementById('user_photo_row');//Make popup visible by modifying height\ndocument.getElementById(\"popup\").style.height=\"50%\";//Clear each div of past elements\nwhile(location_info_div.childElementCount>0){location_info_div.removeChild(location_info_div.lastChild);}while(legacy_photo_div.childElementCount>0){legacy_photo_div.removeChild(legacy_photo_div.lastChild);}while(user_photo_div.childElementCount>0){user_photo_div.removeChild(user_photo_div.lastChild);}createNameDate(element);createThumbImage(element.image_url);getHistoricalImage(element.image_url);});makeImageFullscreen(element.image_url);});});//TODO: Create radio button to change between labeled and non-labeled styles\n//map.setStyle('mapbox://styles/mapbox/outdoors-v11');\n},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"map-container\",style:{height:'100vh'},ref:mapContainer});};export default MapContainer;","map":{"version":3,"names":["React","useRef","useEffect","onValue","mapboxgl","firebase","createNameDate","createThumbImage","getHistoricalImage","makeImageFullscreen","retrieveCapturedImage","setPinLatLong","setUserLatLong","setIndex","accessToken","MapContainer","mapContainer","map","Map","container","current","style","center","zoom","addControl","NavigationControl","geolocate","GeolocateControl","positionOptions","enableHighAccuracy","trackUserLocation","showUserHeading","on","position","userLat","coords","latitude","userLong","longitude","console","log","snapshot","data","val","keys","Object","key","forEach","element","marker","Marker","long","lng","lat","setLngLat","addTo","getElement","addEventListener","location_info_div","document","getElementById","legacy_photo_div","user_photo_div","height","childElementCount","removeChild","lastChild","image_url"],"sources":["/Users/nickfaddis/Desktop/SLU/csCapstone/visualizing_whats_lost/react-capacitor-example/src/MapContainer.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport { onValue } from \"firebase/database\";\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css' //Must have this otherwise pins don't anchor\nimport firebase from './query/connect_to_firebase.js';\nimport { createNameDate, createThumbImage, getHistoricalImage, makeImageFullscreen, retrieveCapturedImage } from './Sidebar';\nimport { setPinLatLong, setUserLatLong } from './Location';\nimport { setIndex } from './CameraScreen';\n\nmapboxgl.accessToken = 'pk.eyJ1Ijoibmlja2ZhZGRpcyIsImEiOiJja3Vwemt0amwwbnVoMnZwZ2dreW81OTQwIn0.qerYpAFHJUlYynqbympvAA';\n\nconst MapContainer = () => {\n    const mapContainer = useRef(null);\n   \n    useEffect(() => {\n        const map = new mapboxgl.Map({\n            container: mapContainer.current,\n            style: 'mapbox://styles/nickfaddis/ckurogok00w1l18mmby6l9zsf',\n            center: [-90.221932, 38.632511],\n            zoom: 15\n        });\n\n        map.addControl(new mapboxgl.NavigationControl(), 'top-right');\n\n        let geolocate = new mapboxgl.GeolocateControl({\n            positionOptions: {\n                enableHighAccuracy: true\n            },\n            trackUserLocation: true,\n            showUserHeading: true\n        });\n        map.addControl(geolocate);\n\n        geolocate.on('geolocate', function (position) {\n            const userLat = position.coords.latitude;\n            const userLong = position.coords.longitude;\n            console.log('lat, lng', userLat, userLong);\n            \n            setUserLatLong(userLat, userLong);\n        });\n    \n        onValue(firebase, (snapshot) => {\n            const data = snapshot.val();\n            const keys = Object.keys(data).map(function(key){ return {key, ...data[key]} });\n            \n            keys.forEach(element => {\n                const marker = new mapboxgl.Marker();\n                var long = element.lng;\n                var lat = element.lat;\n                marker.setLngLat([long,lat]);\n                marker.addTo(map);\n\n                marker.getElement().addEventListener('click', () => {\n                    setIndex(element.key);\n                    retrieveCapturedImage(element.key);\n                    setPinLatLong(lat, long);\n                    \n                    //Variables for sidebar divs\n                    var location_info_div = document.getElementById('location_info_row');\n                    var legacy_photo_div = document.getElementById('legacy_photo_row');\n                    var user_photo_div = document.getElementById('user_photo_row');\n\n                    //Make popup visible by modifying height\n                    document.getElementById(\"popup\").style.height = \"50%\";\n\n                    //Clear each div of past elements\n                    while(location_info_div.childElementCount > 0) {\n                        location_info_div.removeChild(location_info_div.lastChild);\n                    }\n                    while(legacy_photo_div.childElementCount > 0) {\n                        legacy_photo_div.removeChild(legacy_photo_div.lastChild);\n                    }\n                    while(user_photo_div.childElementCount > 0) {\n                        user_photo_div.removeChild(user_photo_div.lastChild);\n                    }\n\n                    createNameDate(element);\n                    createThumbImage(element.image_url);\n                    getHistoricalImage(element.image_url);\n                })\n\n                makeImageFullscreen(element.image_url);\n            })\n        });\n\n        //TODO: Create radio button to change between labeled and non-labeled styles\n        //map.setStyle('mapbox://styles/mapbox/outdoors-v11');\n    }, []);\n\n    return <div className=\"map-container\" style={{height: '100vh'}} ref={ mapContainer } />;\n}\n\nexport default MapContainer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}