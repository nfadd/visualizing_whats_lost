{"ast":null,"code":"import _objectSpread from\"/Users/nickfaddis/Desktop/SLU/csCapstone/visualizing_whats_lost/react-capacitor-example/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useRef,useEffect}from'react';import{onValue}from\"firebase/database\";import mapboxgl from'mapbox-gl';import'mapbox-gl/dist/mapbox-gl.css';//Must have this otherwise pins don't anchor\nimport firebase from'./query/connect_to_firebase.js';import{getHistoricalImage,retrieveCapturedImage}from'./Sidebar';import{setPinLatLong,setUserLatLong}from'./Location';import{setIndex}from'./CameraScreen';import{jsx as _jsx}from\"react/jsx-runtime\";mapboxgl.accessToken='pk.eyJ1Ijoibmlja2ZhZGRpcyIsImEiOiJja3Vwemt0amwwbnVoMnZwZ2dreW81OTQwIn0.qerYpAFHJUlYynqbympvAA';var MapContainer=function MapContainer(){var mapContainer=useRef(null);useEffect(function(){var map=new mapboxgl.Map({container:mapContainer.current,style:'mapbox://styles/nickfaddis/ckurogok00w1l18mmby6l9zsf',center:[-90.221932,38.632511],zoom:15});map.addControl(new mapboxgl.NavigationControl(),'top-right');var geolocate=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:true},trackUserLocation:true,showUserHeading:true});map.addControl(geolocate);geolocate.on('geolocate',function(position){var userLat=position.coords.latitude;var userLong=position.coords.longitude;console.log('lat, lng',userLat,userLong);setUserLatLong(userLat,userLong);});onValue(firebase,function(snapshot){var data=snapshot.val();var keys=Object.keys(data).map(function(key){return _objectSpread({key:key},data[key]);});keys.forEach(function(element){var marker=new mapboxgl.Marker();var long=element.lng;var lat=element.lat;marker.setLngLat([long,lat]);marker.addTo(map);marker.getElement().addEventListener('click',function(){setIndex(element.key);retrieveCapturedImage(element.key);setPinLatLong(lat,long);//Variables for sidebar divs\nvar location_info_div=document.getElementById('location_info_row');var legacy_photo_div=document.getElementById('legacy_photo_row');var user_photo_div=document.getElementById('user_photo_row');//Make popup visible by modifying height\ndocument.getElementById(\"popup\").style.height=\"50%\";//Clear each div of past elements\nwhile(location_info_div.childElementCount>0){location_info_div.removeChild(location_info_div.lastChild);}while(legacy_photo_div.childElementCount>0){legacy_photo_div.removeChild(legacy_photo_div.lastChild);}while(user_photo_div.childElementCount>0){user_photo_div.removeChild(user_photo_div.lastChild);}//Initialize the name and date elements\nvar name_par=document.createElement('h1');var name=document.createTextNode(element.Name);name_par.id='location_name';name_par.appendChild(name);location_info_div.appendChild(name_par);if(element.date!==\"NA\"){var date_par=document.createElement('p');var date=document.createTextNode(element.date);date_par.id='location_date';date_par.appendChild(date);location_info_div.appendChild(date_par);}var image=document.createElement('img');image.id=\"thumb_image\";image.src=element.image_url;legacy_photo_div.appendChild(image);getHistoricalImage(element.image_url);/*\n                    var image2_electricboogaloo = document.createElement('img');\n                    image2_electricboogaloo.id = \"thumb_image\";\n                    image2_electricboogaloo.src = element.image_url;\n                    legacy_photo_div.appendChild(image2_electricboogaloo);\n\n                    var user_image = document.createElement('img');\n                    user_image.id = \"thumb_image\";\n                    user_image.src = \"https://www.slu.edu/news/img/2019-news-newslink/january-pics/chaifetz-arial-min.jpg\"\n                    user_photo_div.appendChild(user_image);\n                    */ /*document.addEventListener('click', function(e){\n                        var target = e.target\n                        if (target.id == \"thumb_img\" && target.classList.contains('canfullscreen')){\n                            if (document.fullscreenElement){ // if browser is currently not in full screen\n                                target.requestFullscreen();\n                            }\n                            else{\n                                target.exitFullscreen();\n                            }\n                        }\n                    }, false) */ //Add pictures to bottom div\n//Create container for each image of size x by y\n//When clicking an image, view fullscreen version of image\n/*var node = document.createElement('a');\n                    var name = document.createTextNode(element.Name);\n                    node.appendChild(name);\n                    document.getElementById(\"popup\").appendChild(node);\n                    \n                    var image = document.createElement('img');\n                    image.src = element.image_url;\n                    document.getElementById(\"popup\").appendChild(image);*/});});});//TODO: Create radio button to change between labeled and non-labeled styles\n//map.setStyle('mapbox://styles/mapbox/outdoors-v11');\n},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"map-container\",style:{height:'100vh'},ref:mapContainer});};export default MapContainer;","map":{"version":3,"names":["React","useRef","useEffect","onValue","mapboxgl","firebase","getHistoricalImage","retrieveCapturedImage","setPinLatLong","setUserLatLong","setIndex","accessToken","MapContainer","mapContainer","map","Map","container","current","style","center","zoom","addControl","NavigationControl","geolocate","GeolocateControl","positionOptions","enableHighAccuracy","trackUserLocation","showUserHeading","on","position","userLat","coords","latitude","userLong","longitude","console","log","snapshot","data","val","keys","Object","key","forEach","element","marker","Marker","long","lng","lat","setLngLat","addTo","getElement","addEventListener","location_info_div","document","getElementById","legacy_photo_div","user_photo_div","height","childElementCount","removeChild","lastChild","name_par","createElement","name","createTextNode","Name","id","appendChild","date","date_par","image","src","image_url"],"sources":["/Users/nickfaddis/Desktop/SLU/csCapstone/visualizing_whats_lost/react-capacitor-example/src/MapContainer.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport { onValue } from \"firebase/database\";\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css' //Must have this otherwise pins don't anchor\nimport firebase from './query/connect_to_firebase.js';\nimport { getHistoricalImage, retrieveCapturedImage } from './Sidebar';\nimport { setPinLatLong, setUserLatLong } from './Location';\nimport { setIndex } from './CameraScreen';\n\nmapboxgl.accessToken = 'pk.eyJ1Ijoibmlja2ZhZGRpcyIsImEiOiJja3Vwemt0amwwbnVoMnZwZ2dreW81OTQwIn0.qerYpAFHJUlYynqbympvAA';\n\nconst MapContainer = () => {\n    const mapContainer = useRef(null);\n   \n    useEffect(() => {\n        const map = new mapboxgl.Map({\n            container: mapContainer.current,\n            style: 'mapbox://styles/nickfaddis/ckurogok00w1l18mmby6l9zsf',\n            center: [-90.221932, 38.632511],\n            zoom: 15\n        });\n\n        map.addControl(new mapboxgl.NavigationControl(), 'top-right');\n\n        let geolocate = new mapboxgl.GeolocateControl({\n            positionOptions: {\n                enableHighAccuracy: true\n            },\n            trackUserLocation: true,\n            showUserHeading: true\n        });\n        map.addControl(geolocate);\n\n        geolocate.on('geolocate', function (position) {\n            const userLat = position.coords.latitude;\n            const userLong = position.coords.longitude;\n            console.log('lat, lng', userLat, userLong);\n            \n            setUserLatLong(userLat, userLong);\n        });\n    \n        onValue(firebase, (snapshot) => {\n            const data = snapshot.val();\n            const keys = Object.keys(data).map(function(key){ return {key, ...data[key]}});\n            \n            keys.forEach(element => {\n                const marker = new mapboxgl.Marker();\n                var long = element.lng;\n                var lat = element.lat;\n                marker.setLngLat([long,lat]);\n                marker.addTo(map);\n\n                marker.getElement().addEventListener('click', () => {\n                    setIndex(element.key);\n                    retrieveCapturedImage(element.key);\n                    setPinLatLong(lat, long);\n                    //Variables for sidebar divs\n                    var location_info_div = document.getElementById('location_info_row');\n                    var legacy_photo_div = document.getElementById('legacy_photo_row');\n                    var user_photo_div = document.getElementById('user_photo_row');\n\n                    //Make popup visible by modifying height\n                    document.getElementById(\"popup\").style.height = \"50%\";\n\n                    //Clear each div of past elements\n                    while(location_info_div.childElementCount > 0) {\n                        location_info_div.removeChild(location_info_div.lastChild);\n                    }\n                    while(legacy_photo_div.childElementCount > 0) {\n                        legacy_photo_div.removeChild(legacy_photo_div.lastChild);\n                    }\n                    while(user_photo_div.childElementCount > 0) {\n                        user_photo_div.removeChild(user_photo_div.lastChild);\n                    }\n\n                    //Initialize the name and date elements\n                    var name_par = document.createElement('h1');\n                    var name = document.createTextNode(element.Name);\n                    name_par.id = 'location_name'\n                    name_par.appendChild(name);\n                    location_info_div.appendChild(name_par);\n                    if (element.date !== \"NA\") {\n                        var date_par = document.createElement('p');\n                        var date = document.createTextNode(element.date);\n                        date_par.id = 'location_date'\n                        date_par.appendChild(date);\n                        location_info_div.appendChild(date_par);\n                    }\n\n                    var image = document.createElement('img');\n                    image.id = \"thumb_image\";\n                    image.src = element.image_url;\n                    legacy_photo_div.appendChild(image);\n                    getHistoricalImage(element.image_url);\n\n                    /*\n                    var image2_electricboogaloo = document.createElement('img');\n                    image2_electricboogaloo.id = \"thumb_image\";\n                    image2_electricboogaloo.src = element.image_url;\n                    legacy_photo_div.appendChild(image2_electricboogaloo);\n\n                    var user_image = document.createElement('img');\n                    user_image.id = \"thumb_image\";\n                    user_image.src = \"https://www.slu.edu/news/img/2019-news-newslink/january-pics/chaifetz-arial-min.jpg\"\n                    user_photo_div.appendChild(user_image);\n                    */\n\n\n                    \n                    /*document.addEventListener('click', function(e){\n                        var target = e.target\n                        if (target.id == \"thumb_img\" && target.classList.contains('canfullscreen')){\n                            if (document.fullscreenElement){ // if browser is currently not in full screen\n                                target.requestFullscreen();\n                            }\n                            else{\n                                target.exitFullscreen();\n                            }\n                        }\n                    }, false) */\n                    \n                    //Add pictures to bottom div\n\n                    //Create container for each image of size x by y\n                    //When clicking an image, view fullscreen version of image\n                    \n\n                    /*var node = document.createElement('a');\n                    var name = document.createTextNode(element.Name);\n                    node.appendChild(name);\n                    document.getElementById(\"popup\").appendChild(node);\n                    \n                    var image = document.createElement('img');\n                    image.src = element.image_url;\n                    document.getElementById(\"popup\").appendChild(image);*/\n                    \n                })\n            })\n        });\n\n        //TODO: Create radio button to change between labeled and non-labeled styles\n        //map.setStyle('mapbox://styles/mapbox/outdoors-v11');\n    }, []);\n\n    return <div className=\"map-container\" style={{height: '100vh'}} ref={ mapContainer } />;\n}\n\nexport default MapContainer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}